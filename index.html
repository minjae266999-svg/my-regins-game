<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ethical Governor: Dilemma</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --bg-color: #222;
            --text-color: #eee;
            --card-bg: #fff;
            --card-text: #333;
            /* 4대 자원 색상 */
            --accent-trust: #4CAF50; /* 시민신뢰 - 초록 */
            --accent-ethic: #9C27B0; /* 윤리정당 - 보라 */
            --accent-intl: #2196F3;  /* 국제관계 - 파랑 */
            --accent-stable: #FF9800; /* 국가안정 - 주황 */
        }

        * { box-sizing: border-box; margin: 0; padding: 0; user-select: none; -webkit-user-drag: none; }
        
        body {
            font-family: 'Pretendard', -apple-system, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        /* 상단 게이지 영역 */
        #stats-container {
            display: flex;
            justify-content: space-around;
            padding: 15px 5px;
            background: rgba(0,0,0,0.5);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid #444;
        }

        .stat-box {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 23%;
        }

        .stat-icon { font-size: 1.2rem; margin-bottom: 5px; }
        
        .stat-bar-bg {
            width: 100%; height: 6px; background: #444;
            border-radius: 3px; overflow: hidden; margin-bottom: 4px;
        }

        .stat-bar-fill {
            height: 100%; width: 50%;
            transition: width 0.4s ease, background-color 0.3s;
        }

        .stat-label { font-size: 0.7rem; color: #aaa; font-weight: 600; }

        /* 턴 카운터 */
        #turn-counter {
            text-align: center; font-size: 0.8rem; color: #666; margin-top: 10px;
        }

        /* 게임 영역 */
        #game-area {
            flex: 1; display: flex; flex-direction: column;
            justify-content: center; align-items: center;
            position: relative; perspective: 1000px;
        }

        #card {
            width: 300px; height: 460px;
            background: var(--card-bg); color: var(--card-text);
            border-radius: 15px; position: absolute;
            box-shadow: 0 15px 30px rgba(0,0,0,0.5);
            display: flex; flex-direction: column; overflow: hidden;
            transform-origin: 50% 100%; cursor: grab; z-index: 10;
        }

        .card-image-wrapper {
            width: 100%; height: 55%; background: #ddd;
            position: relative; overflow: hidden;
        }

        .card-image { width: 100%; height: 100%; object-fit: cover; }

        .card-overlay {
            position: absolute; top: 30px;
            font-size: 2rem; font-weight: 800; padding: 5px 10px;
            border: 4px solid; border-radius: 8px; opacity: 0; z-index: 20;
        }
        .overlay-left { right: 20px; color: #E91E63; border-color: #E91E63; transform: rotate(15deg); } /* 거절/Left */
        .overlay-right { left: 20px; color: #4CAF50; border-color: #4CAF50; transform: rotate(-15deg); } /* 승인/Right */

        .card-content {
            padding: 20px; text-align: center; flex: 1;
            display: flex; flex-direction: column; justify-content: center;
        }

        .character-name {
            font-size: 0.9rem; font-weight: 700; color: #666;
            margin-bottom: 8px; letter-spacing: 1px;
        }

        .question-text {
            font-size: 1.1rem; line-height: 1.45; font-weight: 700; word-break: keep-all;
        }

        /* 하단 버튼 */
        #controls { padding: 25px; display: flex; justify-content: center; gap: 15px; }
        .control-btn {
            background: transparent; border: 1px solid #666; color: #ddd;
            padding: 12px 20px; border-radius: 25px; font-size: 0.9rem;
            cursor: pointer; transition: 0.2s;
        }
        .control-btn:active { background: #444; }

        /* 엔딩 오버레이 */
        #game-over {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.95); display: flex; flex-direction: column;
            justify-content: center; align-items: center; z-index: 100;
            opacity: 0; pointer-events: none; transition: opacity 0.5s; padding: 20px; text-align: center;
        }
        #game-over.active { opacity: 1; pointer-events: all; }
        
        #game-over h1 { font-size: 2rem; margin-bottom: 10px; color: #fff; }
        #ending-type { font-size: 1.5rem; font-weight: bold; color: var(--accent-ethic); margin-bottom: 15px; }
        #game-over-msg { font-size: 1rem; color: #ccc; margin-bottom: 30px; line-height: 1.6; max-width: 400px; }
        
        #restart-btn {
            background: #fff; color: #000; border: none; padding: 12px 30px;
            font-size: 1.1rem; border-radius: 30px; cursor: pointer; font-weight: bold;
        }
    </style>
</head>
<body>

   <div id="stats-container">
    <div class="stat-box">
        <i class="fa-solid fa-users stat-icon" style="color:var(--accent-trust)"></i>
        <div class="stat-bar-bg">
            <div id="bar-trust" class="stat-bar-fill" style="background:var(--accent-trust)"></div>
            <span id="val-trust" class="stat-value">50</span>
        </div>
        <div class="stat-label">시민신뢰</div>
    </div>
    <div class="stat-box">
        <i class="fa-solid fa-scale-balanced stat-icon" style="color:var(--accent-ethic)"></i>
        <div class="stat-bar-bg">
            <div id="bar-ethic" class="stat-bar-fill" style="background:var(--accent-ethic)"></div>
            <span id="val-ethic" class="stat-value">50</span>
        </div>
        <div class="stat-label">윤리정당</div>
    </div>
    <div class="stat-box">
        <i class="fa-solid fa-earth-americas stat-icon" style="color:var(--accent-intl)"></i>
        <div class="stat-bar-bg">
            <div id="bar-intl" class="stat-bar-fill" style="background:var(--accent-intl)"></div>
            <span id="val-intl" class="stat-value">50</span>
        </div>
        <div class="stat-label">국제관계</div>
    </div>
    <div class="stat-box">
        <i class="fa-solid fa-shield-halved stat-icon" style="color:var(--accent-stable)"></i>
        <div class="stat-bar-bg">
            <div id="bar-stable" class="stat-bar-fill" style="background:var(--accent-stable)"></div>
            <span id="val-stable" class="stat-value">50</span>
        </div>
        <div class="stat-label">국가안정</div>
    </div>
</div>
<style>
    /* 게이지 숫자 스타일 추가 */
    .stat-bar-bg {
        position: relative; /* 숫자를 바 위에 띄우기 위해 필요 */
        width: 100%; height: 14px; /* 숫자가 보이도록 높이 약간 조절 */
        background: #444;
        border-radius: 7px; overflow: hidden; margin-bottom: 4px;
    }

  .stat-value {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    z-index: 10; /* 바보다 위에 오도록 */
    font-size: 11px;
    font-weight: bold;
    color: white;
    text-shadow: -1px -1px 0 #000, 1px -1px 0 #000, -1px 1px 0 #000, 1px 1px 0 #000;
    pointer-events: none;
}
    }
    
    .stat-bar-fill {
        height: 100%; width: 50%;
        transition: width 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    }
</style>

<script>
    // 자바스크립트 업데이트 함수 수정
    function updateStatsUI() {
        for (const [key, value] of Object.entries(stats)) {
            // 바 길이 업데이트
            bars[key].style.width = value + '%';
            
            // 숫자 텍스트 업데이트 (추가된 부분)
            const valEl = document.getElementById('val-' + key);
            if (valEl) valEl.textContent = value;

            // 위험 수치 표시 (20 이하 또는 80 이상)
            if(value <= 20 || value >= 80) {
                bars[key].parentElement.style.boxShadow = "0 0 5px red";
            } else {
                bars[key].parentElement.style.boxShadow = "none";
            }
        }
    }
</script>
    <div id="turn-counter">임기: 1 / 20</div>

    <div id="game-area">
        <div id="card">
            <div class="card-overlay overlay-right" id="overlay-yes">YES</div>
            <div class="card-overlay overlay-left" id="overlay-no">NO</div>
            
            <div class="card-image-wrapper">
                <img src="" alt="Character" id="char-img" class="card-image">
            </div>
            <div class="card-content">
                <div id="char-name" class="character-name">캐릭터</div>
                <div id="question" class="question-text">질문</div>
            </div>
        </div>
    </div>

    <div id="controls">
        <button class="control-btn" id="btn-left">◀ 선택 A</button>
        <button class="control-btn" id="btn-right">선택 B ▶</button>
    </div>

    <div id="game-over">
        <h1 id="end-title">GAME OVER</h1>
        <div id="ending-type"></div>
        <p id="game-over-msg">결과 메시지</p>
        <button id="restart-btn" onclick="initGame()">다시 통치하기</button>
    </div>

<script>
    // --- [기획안 기반] 시나리오 데이터 (20개) ---
    // image: 로컬 이미지가 있다면 "images/파일명.png"로 변경하세요.
    // 지금은 테스트를 위해 온라인 랜덤 이미지를 배정했습니다.
    const scenarios = [
        // 1. 보안 vs 자유
        {
            character: "보안 사령관",
            image: "https://images.unsplash.com/photo-1542909168-82c3e7fdca5c?auto=format&fit=crop&w=400&q=80",
            question: "범죄율이 급증하고 있습니다. AI 감시 시스템을 전면 도입하여 도시를 24시간 감시할까요?",
            leftChoice: { label: "거부 (자유)", effects: { trust: 10, stable: -10, ethic: 10, intl: 0 } },
            rightChoice: { label: "도입 (안전)", effects: { trust: -15, stable: 20, ethic: -15, intl: 0 } }
        },
        // 2. 난민 (국제 vs 국익)
        {
            character: "외교 사절",
            image: "https://images.unsplash.com/photo-1573496359142-b8d87734a5a2?auto=format&fit=crop&w=400&q=80",
            question: "기후 재난으로 인접국 난민이 국경에 몰렸습니다. 전면 수용하시겠습니까?",
            leftChoice: { label: "제한 수용", effects: { trust: 5, stable: 10, ethic: -5, intl: -15 } },
            rightChoice: { label: "전면 수용", effects: { trust: -10, stable: -20, ethic: 15, intl: 20 } }
        },
        // 3. 역사 정의 (정의 vs 법치)
        {
            character: "법무부 장관",
            image: "https://images.unsplash.com/photo-1589829545856-d10d557cf95f?auto=format&fit=crop&w=400&q=80",
            question: "과거 독재 시절 부정 축재한 가문의 재산을 지금 환수하라는 여론이 거셉니다. 법적 시효가 지났습니다.",
            leftChoice: { label: "법치 (불허)", effects: { trust: -15, stable: 10, ethic: -5, intl: 0 } },
            rightChoice: { label: "정의 (환수)", effects: { trust: 15, stable: -10, ethic: 10, intl: 0 } }
        },
        // 4. 유전자 편집 (기술 vs 윤리)
        {
            character: "과학 기술자",
            image: "https://images.unsplash.com/photo-1532094349884-543bc11b234d?auto=format&fit=crop&w=400&q=80",
            question: "질병 면역력을 갖춘 '유전자 편집 아기' 시술 허용을 요청합니다. 부유층의 요구가 거셉니다.",
            leftChoice: { label: "금지 (윤리)", effects: { trust: 5, stable: -5, ethic: 20, intl: 0 } },
            rightChoice: { label: "허용 (경쟁)", effects: { trust: -10, stable: 15, ethic: -20, intl: 5 } }
        },
        // 5. 혐오 표현 (표현의 자유 vs 약자 보호)
        {
            character: "인권 변호사",
            image: "https://images.unsplash.com/photo-1573497019940-1c28c88b4f3e?auto=format&fit=crop&w=400&q=80",
            question: "온라인 혐오 표현을 강력 처벌하는 법안입니다. 표현의 자유 침해 우려가 있습니다.",
            leftChoice: { label: "자율 규제", effects: { trust: -10, stable: 0, ethic: 5, intl: 0 } },
            rightChoice: { label: "법안 통과", effects: { trust: 15, stable: 5, ethic: -10, intl: 0 } }
        },
        // 6. 환경 (현재 vs 미래)
        {
            character: "환경 운동가",
            image: "https://images.unsplash.com/photo-1544005313-94ddf0286df2?auto=format&fit=crop&w=400&q=80",
            question: "탄소 감축 목표를 위해 주요 공장 가동을 강제로 중단해야 합니다. 경제 타격이 예상됩니다.",
            leftChoice: { label: "경제 유지", effects: { trust: 5, stable: 10, ethic: -10, intl: -15 } },
            rightChoice: { label: "강제 중단", effects: { trust: -15, stable: -15, ethic: 15, intl: 15 } }
        },
        // 7. AI 판사 (인간성 vs 효율성)
        {
            character: "철학자 관료",
            image: "https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?auto=format&fit=crop&w=400&q=80",
            question: "AI 판사는 감정 없이 24시간 공정하게 재판합니다. 사법부에 전면 도입할까요?",
            leftChoice: { label: "인간 판사", effects: { trust: -5, stable: -5, ethic: 10, intl: 0 } },
            rightChoice: { label: "AI 도입", effects: { trust: 5, stable: 15, ethic: -15, intl: 5 } }
        },
        // 8. 노키즈존 (차별 vs 영업자유)
        {
            character: "시민 대표",
            image: "https://images.unsplash.com/photo-1554151228-14d9def656ec?auto=format&fit=crop&w=400&q=80",
            question: "상점 주인이 '노 키즈 존(아동 출입 금지)'을 설정할 권리를 법적으로 보장해달라고 합니다.",
            leftChoice: { label: "금지 (차별)", effects: { trust: 5, stable: 0, ethic: 10, intl: 0 } },
            rightChoice: { label: "허용 (자유)", effects: { trust: 5, stable: 5, ethic: -10, intl: 0 } }
        },
        // 9. 테러 협상 (원칙 vs 생명)
        {
            character: "보안 사령관",
            image: "https://images.unsplash.com/photo-1542909168-82c3e7fdca5c?auto=format&fit=crop&w=400&q=80",
            question: "테러 단체가 국민을 납치했습니다. 몸값을 주면 풀려나지만, 그 돈은 무기 구입에 쓰입니다.",
            leftChoice: { label: "협상 거부", effects: { trust: -20, stable: 10, ethic: -5, intl: 5 } },
            rightChoice: { label: "몸값 지불", effects: { trust: 20, stable: -15, ethic: 5, intl: -5 } }
        },
        // 10. 기본소득 (복지 vs 재정)
        {
            character: "경제 고문",
            image: "https://images.unsplash.com/photo-1560250097-0b93528c311a?auto=format&fit=crop&w=400&q=80",
            question: "모든 국민에게 조건 없이 매달 현금을 지급하는 '기본소득'을 도입하시겠습니까?",
            leftChoice: { label: "반대 (재정)", effects: { trust: -10, stable: 15, ethic: 0, intl: 5 } },
            rightChoice: { label: "찬성 (복지)", effects: { trust: 20, stable: -20, ethic: 5, intl: -5 } }
        },
        // 11. 트롤리 딜레마 (자율주행)
        {
            character: "기술 개발자",
            image: "https://images.unsplash.com/photo-1532094349884-543bc11b234d?auto=format&fit=crop&w=400&q=80",
            question: "자율주행차가 사고 직전입니다. 탑승자를 보호할까요, 더 많은 보행자를 보호할까요?",
            leftChoice: { label: "탑승자 우선", effects: { trust: 5, stable: 5, ethic: -20, intl: 0 } },
            rightChoice: { label: "보행자 우선", effects: { trust: -10, stable: -5, ethic: 20, intl: 0 } }
        },
        // 12. 동물 실험 (생명 vs 발전)
        {
            character: "제약 회사 대표",
            image: "https://images.unsplash.com/photo-1560250097-0b93528c311a?auto=format&fit=crop&w=400&q=80",
            question: "난치병 치료제 개발을 위해 대규모 동물 실험이 필수적입니다. 허가하시겠습니까?",
            leftChoice: { label: "금지 (생명)", effects: { trust: 5, stable: -10, ethic: 15, intl: 0 } },
            rightChoice: { label: "허용 (발전)", effects: { trust: 0, stable: 15, ethic: -15, intl: 5 } }
        },
        // 13. 알 권리 vs 프라이버시
        {
            character: "질병관리청장",
            image: "https://images.unsplash.com/photo-1573496359142-b8d87734a5a2?auto=format&fit=crop&w=400&q=80",
            question: "전염병 확산을 막기 위해 확진자의 모든 동선을 공개해야 합니다. 사생활 침해가 우려됩니다.",
            leftChoice: { label: "비공개", effects: { trust: 10, stable: -10, ethic: 10, intl: 0 } },
            rightChoice: { label: "전체 공개", effects: { trust: -10, stable: 15, ethic: -10, intl: 0 } }
        },
        // 14. 문화재 반환
        {
            character: "문화부 장관",
            image: "https://images.unsplash.com/photo-1589829545856-d10d557cf95f?auto=format&fit=crop&w=400&q=80",
            question: "과거 제국주의 시절 우리가 약탈해온 유물을 돌려달라는 요구가 왔습니다.",
            leftChoice: { label: "반환 거부", effects: { trust: 10, stable: 5, ethic: -10, intl: -15 } },
            rightChoice: { label: "유물 반환", effects: { trust: -15, stable: -5, ethic: 15, intl: 20 } }
        },
        // 15. 안락사
        {
            character: "의사 협회장",
            image: "https://images.unsplash.com/photo-1532094349884-543bc11b234d?auto=format&fit=crop&w=400&q=80",
            question: "고통받는 말기 환자가 존엄하게 죽을 권리(안락사)를 합법화해달라고 합니다.",
            leftChoice: { label: "불허 (생명)", effects: { trust: -5, stable: 0, ethic: 10, intl: 0 } },
            rightChoice: { label: "허용 (존엄)", effects: { trust: 10, stable: 0, ethic: -10, intl: 5 } }
        }
    ];

    // --- 게임 상태 ---
    let stats = { trust: 50, ethic: 50, intl: 50, stable: 50 };
    let currentCardIndex = 0;
    let deck = [];
    let turnCount = 0;
    const MAX_TURNS = 20; // 임기 20턴

    // --- DOM 요소 ---
    const cardEl = document.getElementById('card');
    const charImgEl = document.getElementById('char-img');
    const charNameEl = document.getElementById('char-name');
    const questionEl = document.getElementById('question');
    const overlayYes = document.getElementById('overlay-yes');
    const overlayNo = document.getElementById('overlay-no');
    const turnEl = document.getElementById('turn-counter');
    
    const bars = {
        trust: document.getElementById('bar-trust'),
        ethic: document.getElementById('bar-ethic'),
        intl: document.getElementById('bar-intl'),
        stable: document.getElementById('bar-stable')
    };

    function initGame() {
        stats = { trust: 50, ethic: 50, intl: 50, stable: 50 };
        turnCount = 1;
        updateStatsUI();
        deck = [...scenarios].sort(() => Math.random() - 0.5); // 덱 셔플
        currentCardIndex = 0;
        loadCard();
        document.getElementById('game-over').classList.remove('active');
    }

    function loadCard() {
        // 임기 종료 체크
        if (turnCount > MAX_TURNS) {
            analyzeEnding();
            return;
        }

        // 덱이 떨어지면 다시 셔플
        if (currentCardIndex >= deck.length) {
            deck = [...scenarios].sort(() => Math.random() - 0.5);
            currentCardIndex = 0;
        }

        const cardData = deck[currentCardIndex];
        
        // 이미지 및 텍스트 설정
        charImgEl.src = cardData.image;
        charNameEl.textContent = cardData.character;
        questionEl.textContent = cardData.question;
        
        overlayNo.textContent = cardData.leftChoice.label;
        overlayYes.textContent = cardData.rightChoice.label;
        
        document.getElementById('btn-left').textContent = "◀ " + cardData.leftChoice.label;
        document.getElementById('btn-right').textContent = cardData.rightChoice.label + " ▶";
        
        turnEl.textContent = `임기: ${turnCount} / ${MAX_TURNS}`;

        // 카드 위치 초기화
        cardEl.style.transition = 'none';
        cardEl.style.transform = 'translate(0, 0) rotate(0deg)';
        overlayYes.style.opacity = 0;
        overlayNo.style.opacity = 0;
    }

    function updateStatsUI() {
    for (const [key, value] of Object.entries(stats)) {
        // 1. 게이지 바(그래프) 길이 업데이트
        const barEl = document.getElementById('bar-' + key);
        if (barEl) {
            barEl.style.width = value + '%';
        }
        
        // 2. 중요: 숫자 텍스트를 현재 데이터(value)로 업데이트
        const valEl = document.getElementById('val-' + key);
        if (valEl) {
            valEl.textContent = Math.round(value); // 소수점을 반올림하여 정수로 표시
        }

        // 3. (선택) 수치가 위험할 때 시각적 피드백
        if (value <= 20 || value >= 80) {
            if (valEl) valEl.style.color = "#ff4444"; // 위험 수치일 때 숫자 빨간색
        } else {
            if (valEl) valEl.style.color = "white";   // 정상일 때 흰색
        }
    }
}

    function handleChoice(direction) {
        const cardData = deck[currentCardIndex];
        const effects = direction === 'right' ? cardData.rightChoice.effects : cardData.leftChoice.effects;

        // 능력치 적용
        for (const key in effects) {
            stats[key] += effects[key];
            if (stats[key] > 100) stats[key] = 100;
            if (stats[key] < 0) stats[key] = 0;
        }
        updateStatsUI();

        // 사망 체크
        const deathReason = checkDeath();
        if (deathReason) {
            showGameOver("축출되었습니다", deathReason, "실패");
        } else {
            // 생존 시 다음 턴
            animateCardExit(direction, () => {
                turnCount++;
                currentCardIndex++;
                loadCard();
            });
        }
    }

    // 중간에 게임오버(사망)하는 조건
    function checkDeath() {
        if (stats.trust <= 0) return "시민들이 폭동을 일으켜 청와대를 점거했습니다.";
        if (stats.trust >= 100) return "지나친 포퓰리즘으로 국가 기능이 마비되었습니다.";
        if (stats.ethic <= 0) return "정부의 도덕적 타락으로 탄핵당했습니다.";
        if (stats.intl <= 0) return "국제 사회의 제재로 경제가 붕괴했습니다.";
        if (stats.stable <= 0) return "무정부 상태가 되어 쿠데타가 발생했습니다.";
        return null;
    }

    // 임기 만료 시 성향 분석 엔딩
    function analyzeEnding() {
        let title = "";
        let desc = "";
        let type = "";

        // 우선순위 로직: 가장 특징적인 스탯을 기반으로 판정
        if (stats.ethic >= 80 && stats.trust >= 60) {
            title = "성공적인 통치";
            type = "철인 통치자 (Philosopher King)";
            desc = "당신은 도덕적 가치와 시민의 신뢰를 모두 지켰습니다. 역사는 당신을 가장 이상적인 지도자로 기억할 것입니다.";
        } else if (stats.stable >= 80 && stats.ethic <= 40) {
            title = "차가운 통치";
            type = "효율적 독재자 (Leviathan)";
            desc = "국가는 부강해지고 질서는 잡혔지만, 도덕과 인권은 희생되었습니다. 시민들은 당신을 두려워합니다.";
        } else if (stats.trust >= 80 && stats.stable <= 40) {
            title = "위태로운 인기";
            type = "포퓰리스트 (Populist)";
            desc = "시민들의 환심은 샀지만, 국가는 혼란스럽습니다. 당신의 정책은 인기영합적이었다는 비판을 받습니다.";
        } else if (stats.intl >= 80 && stats.trust <= 40) {
            title = "외부의 찬사";
            type = "세계 시민 (Cosmopolitan)";
            desc = "국제 사회에서는 칭송받지만, 정작 자국민들은 고통받았습니다. 밖에서만 좋은 지도자였습니다.";
        } else {
            title = "무난한 통치";
            type = "실용주의자 (Pragmatist)";
            desc = "큰 위기 없이 임기를 마쳤습니다. 특별한 철학보다는 상황에 맞춰 적절히 타협하며 국가를 이끌었습니다.";
        }

        showGameOver(title, desc, type);
    }

    function showGameOver(title, msg, type) {
        document.getElementById('end-title').textContent = title;
        document.getElementById('ending-type').textContent = type;
        document.getElementById('game-over-msg').textContent = msg;
        document.getElementById('game-over').classList.add('active');
    }

    function animateCardExit(direction, callback) {
        const xOffset = direction === 'right' ? 1000 : -1000;
        cardEl.style.transition = 'transform 0.4s ease-out';
        cardEl.style.transform = `translate(${xOffset}px, 100px) rotate(${direction === 'right' ? 30 : -30}deg)`;
        setTimeout(callback, 400);
    }

    // --- 드래그 이벤트 (PC/모바일 공용) ---
    let startX = 0, currentX = 0, isDragging = false;
    
    cardEl.addEventListener('mousedown', startDrag);
    cardEl.addEventListener('touchstart', startDrag);
    document.addEventListener('mousemove', moveDrag);
    document.addEventListener('touchmove', moveDrag);
    document.addEventListener('mouseup', endDrag);
    document.addEventListener('touchend', endDrag);
    
    // 버튼 클릭 연결
    document.getElementById('btn-left').onclick = () => handleChoice('left');
    document.getElementById('btn-right').onclick = () => handleChoice('right');

    function startDrag(e) {
        isDragging = true;
        startX = (e.type === 'touchstart') ? e.touches[0].clientX : e.clientX;
        cardEl.style.transition = 'none';
    }
    function moveDrag(e) {
        if (!isDragging) return;
        currentX = (e.type === 'touchmove') ? e.touches[0].clientX : e.clientX;
        const deltaX = currentX - startX;
        cardEl.style.transform = `translate(${deltaX}px, 0) rotate(${deltaX * 0.05}deg)`;
        
        if (deltaX > 0) {
            overlayYes.style.opacity = Math.min(deltaX / 100, 1);
            overlayNo.style.opacity = 0;
        } else {
            overlayNo.style.opacity = Math.min(Math.abs(deltaX) / 100, 1);
            overlayYes.style.opacity = 0;
        }
    }
    function endDrag(e) {
        if (!isDragging) return;
        isDragging = false;
        const deltaX = currentX - startX;
        if (Math.abs(deltaX) > 100) handleChoice(deltaX > 0 ? 'right' : 'left');
        else {
            cardEl.style.transition = 'transform 0.3s';
            cardEl.style.transform = 'translate(0, 0) rotate(0deg)';
            overlayYes.style.opacity = 0; overlayNo.style.opacity = 0;
        }
    }

    // 게임 시작
    initGame();
</script>
</body>
</html>